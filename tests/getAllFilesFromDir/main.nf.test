nextflow_pipeline {

    name "Test getAllFilesFromDir"
    script "./main.nf"
    tag "getAllFilesFromDir"

    test("getAllFilesFromDir") {
        when {
            params {
                outdir = "$outputDir"
            }
        }

        then {
          def timestamp      = [/.*\d{4}-\d{2}-\d{2}_\d{2}-\d{2}-\d{2}.*/]
          def stable_name    = getAllFilesFromDir(params.outdir, false, timestamp)
          def stable_content = getAllFilesFromDir(params.outdir, false, timestamp + [/stable_name\.txt/] )
          assert snapshot(
            // Only snapshot name
            stable_name*.name,
            // Snapshot content
            stable_content
          ).match()
        }
    }
}
