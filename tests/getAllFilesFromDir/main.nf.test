nextflow_pipeline {

    name "Test getAllFilesFromDir"
    script "./main.nf"
    tag "getAllFilesFromDir"

    test("getAllFilesFromDir") {
        when {
            params {
                outdir = "$outputDir"
            }
        }

        then {
          // Use getAllFilesFromDir() to get a list of all files and folders from the output directory, minus the timestamped files
          def stable_name    = getAllFilesFromDir(params.outdir, true, ['**/*[0-9]*.txt'] )
          // Use getAllFilesFromDir() to get a list of all files from the output directory, minus the non-stable files
          def stable_content = getAllFilesFromDir(params.outdir, false, 'tests/getAllFilesFromDir/.nftignore' )
          assert snapshot(
            // Only snapshot name
            stable_name*.name,
            // Snapshot content
            stable_content
          ).match()
        }
    }
}
